{"version":3,"file":"pow_wasm-CWic9xMP.js","sources":["../pow-wasm/pkg/pow_wasm.js"],"sourcesContent":["let wasm;\n\nlet cachedUint8ArrayMemory0 = null;\n\nfunction getUint8ArrayMemory0() {\n    if (cachedUint8ArrayMemory0 === null || cachedUint8ArrayMemory0.byteLength === 0) {\n        cachedUint8ArrayMemory0 = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachedUint8ArrayMemory0;\n}\n\nlet cachedTextDecoder = new TextDecoder('utf-8', { ignoreBOM: true, fatal: true });\n\ncachedTextDecoder.decode();\n\nconst MAX_SAFARI_DECODE_BYTES = 2146435072;\nlet numBytesDecoded = 0;\nfunction decodeText(ptr, len) {\n    numBytesDecoded += len;\n    if (numBytesDecoded >= MAX_SAFARI_DECODE_BYTES) {\n        cachedTextDecoder = new TextDecoder('utf-8', { ignoreBOM: true, fatal: true });\n        cachedTextDecoder.decode();\n        numBytesDecoded = len;\n    }\n    return cachedTextDecoder.decode(getUint8ArrayMemory0().subarray(ptr, ptr + len));\n}\n\nfunction getStringFromWasm0(ptr, len) {\n    ptr = ptr >>> 0;\n    return decodeText(ptr, len);\n}\n/**\n * 获取 WASM 版本信息\n * @returns {string}\n */\nexport function get_version() {\n    let deferred1_0;\n    let deferred1_1;\n    try {\n        const ret = wasm.get_version();\n        deferred1_0 = ret[0];\n        deferred1_1 = ret[1];\n        return getStringFromWasm0(ret[0], ret[1]);\n    } finally {\n        wasm.__wbindgen_free(deferred1_0, deferred1_1, 1);\n    }\n}\n\nlet WASM_VECTOR_LEN = 0;\n\nconst cachedTextEncoder = new TextEncoder();\n\nif (!('encodeInto' in cachedTextEncoder)) {\n    cachedTextEncoder.encodeInto = function (arg, view) {\n        const buf = cachedTextEncoder.encode(arg);\n        view.set(buf);\n        return {\n            read: arg.length,\n            written: buf.length\n        };\n    }\n}\n\nfunction passStringToWasm0(arg, malloc, realloc) {\n\n    if (realloc === undefined) {\n        const buf = cachedTextEncoder.encode(arg);\n        const ptr = malloc(buf.length, 1) >>> 0;\n        getUint8ArrayMemory0().subarray(ptr, ptr + buf.length).set(buf);\n        WASM_VECTOR_LEN = buf.length;\n        return ptr;\n    }\n\n    let len = arg.length;\n    let ptr = malloc(len, 1) >>> 0;\n\n    const mem = getUint8ArrayMemory0();\n\n    let offset = 0;\n\n    for (; offset < len; offset++) {\n        const code = arg.charCodeAt(offset);\n        if (code > 0x7F) break;\n        mem[ptr + offset] = code;\n    }\n\n    if (offset !== len) {\n        if (offset !== 0) {\n            arg = arg.slice(offset);\n        }\n        ptr = realloc(ptr, len, len = offset + arg.length * 3, 1) >>> 0;\n        const view = getUint8ArrayMemory0().subarray(ptr + offset, ptr + len);\n        const ret = cachedTextEncoder.encodeInto(arg, view);\n\n        offset += ret.written;\n        ptr = realloc(ptr, len, offset, 1) >>> 0;\n    }\n\n    WASM_VECTOR_LEN = offset;\n    return ptr;\n}\n/**\n * SHA-256 哈希（返回十六进制字符串）\n * @param {string} input\n * @returns {string}\n */\nexport function sha256(input) {\n    let deferred2_0;\n    let deferred2_1;\n    try {\n        const ptr0 = passStringToWasm0(input, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.sha256(ptr0, len0);\n        deferred2_0 = ret[0];\n        deferred2_1 = ret[1];\n        return getStringFromWasm0(ret[0], ret[1]);\n    } finally {\n        wasm.__wbindgen_free(deferred2_0, deferred2_1, 1);\n    }\n}\n\n/**\n * 单线程完整求解（用于简单场景）\n * @param {string} challenge\n * @param {number} difficulty\n * @param {number} max_iterations\n * @returns {string}\n */\nexport function solve_pow_full(challenge, difficulty, max_iterations) {\n    let deferred2_0;\n    let deferred2_1;\n    try {\n        const ptr0 = passStringToWasm0(challenge, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.solve_pow_full(ptr0, len0, difficulty, max_iterations);\n        deferred2_0 = ret[0];\n        deferred2_1 = ret[1];\n        return getStringFromWasm0(ret[0], ret[1]);\n    } finally {\n        wasm.__wbindgen_free(deferred2_0, deferred2_1, 1);\n    }\n}\n\n/**\n * PoW 求解器 - 在指定范围内搜索 nonce\n *\n * # 参数\n * - `challenge`: PoW 挑战字符串\n * - `difficulty`: 难度（需要的前导零位数，十六进制）\n * - `start_nonce`: 起始 nonce\n * - `batch_size`: 每批搜索的数量\n *\n * # 返回\n * - 找到的 nonce（十六进制字符串），如果没找到返回空字符串\n * @param {string} challenge\n * @param {number} difficulty\n * @param {number} start_nonce\n * @param {number} batch_size\n * @returns {string}\n */\nexport function solve_pow_batch(challenge, difficulty, start_nonce, batch_size) {\n    let deferred2_0;\n    let deferred2_1;\n    try {\n        const ptr0 = passStringToWasm0(challenge, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n        const len0 = WASM_VECTOR_LEN;\n        const ret = wasm.solve_pow_batch(ptr0, len0, difficulty, start_nonce, batch_size);\n        deferred2_0 = ret[0];\n        deferred2_1 = ret[1];\n        return getStringFromWasm0(ret[0], ret[1]);\n    } finally {\n        wasm.__wbindgen_free(deferred2_0, deferred2_1, 1);\n    }\n}\n\nconst EXPECTED_RESPONSE_TYPES = new Set(['basic', 'cors', 'default']);\n\nasync function __wbg_load(module, imports) {\n    if (typeof Response === 'function' && module instanceof Response) {\n        if (typeof WebAssembly.instantiateStreaming === 'function') {\n            try {\n                return await WebAssembly.instantiateStreaming(module, imports);\n\n            } catch (e) {\n                const validResponse = module.ok && EXPECTED_RESPONSE_TYPES.has(module.type);\n\n                if (validResponse && module.headers.get('Content-Type') !== 'application/wasm') {\n                    console.warn(\"`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\\n\", e);\n\n                } else {\n                    throw e;\n                }\n            }\n        }\n\n        const bytes = await module.arrayBuffer();\n        return await WebAssembly.instantiate(bytes, imports);\n\n    } else {\n        const instance = await WebAssembly.instantiate(module, imports);\n\n        if (instance instanceof WebAssembly.Instance) {\n            return { instance, module };\n\n        } else {\n            return instance;\n        }\n    }\n}\n\nfunction __wbg_get_imports() {\n    const imports = {};\n    imports.wbg = {};\n    imports.wbg.__wbindgen_init_externref_table = function() {\n        const table = wasm.__wbindgen_externrefs;\n        const offset = table.grow(4);\n        table.set(0, undefined);\n        table.set(offset + 0, undefined);\n        table.set(offset + 1, null);\n        table.set(offset + 2, true);\n        table.set(offset + 3, false);\n        ;\n    };\n\n    return imports;\n}\n\nfunction __wbg_finalize_init(instance, module) {\n    wasm = instance.exports;\n    __wbg_init.__wbindgen_wasm_module = module;\n    cachedUint8ArrayMemory0 = null;\n\n\n    wasm.__wbindgen_start();\n    return wasm;\n}\n\nfunction initSync(module) {\n    if (wasm !== undefined) return wasm;\n\n\n    if (typeof module !== 'undefined') {\n        if (Object.getPrototypeOf(module) === Object.prototype) {\n            ({module} = module)\n        } else {\n            console.warn('using deprecated parameters for `initSync()`; pass a single object instead')\n        }\n    }\n\n    const imports = __wbg_get_imports();\n\n    if (!(module instanceof WebAssembly.Module)) {\n        module = new WebAssembly.Module(module);\n    }\n\n    const instance = new WebAssembly.Instance(module, imports);\n\n    return __wbg_finalize_init(instance, module);\n}\n\nasync function __wbg_init(module_or_path) {\n    if (wasm !== undefined) return wasm;\n\n\n    if (typeof module_or_path !== 'undefined') {\n        if (Object.getPrototypeOf(module_or_path) === Object.prototype) {\n            ({module_or_path} = module_or_path)\n        } else {\n            console.warn('using deprecated parameters for the initialization function; pass a single object instead')\n        }\n    }\n\n    if (typeof module_or_path === 'undefined') {\n        module_or_path = new URL('pow_wasm_bg.wasm', import.meta.url);\n    }\n    const imports = __wbg_get_imports();\n\n    if (typeof module_or_path === 'string' || (typeof Request === 'function' && module_or_path instanceof Request) || (typeof URL === 'function' && module_or_path instanceof URL)) {\n        module_or_path = fetch(module_or_path);\n    }\n\n    const { instance, module } = await __wbg_load(await module_or_path, imports);\n\n    return __wbg_finalize_init(instance, module);\n}\n\nexport { initSync };\nexport default __wbg_init;\n"],"names":["wasm","cachedUint8ArrayMemory0","getUint8ArrayMemory0","cachedTextDecoder","MAX_SAFARI_DECODE_BYTES","numBytesDecoded","decodeText","ptr","len","getStringFromWasm0","get_version","deferred1_0","deferred1_1","ret","WASM_VECTOR_LEN","cachedTextEncoder","arg","view","buf","passStringToWasm0","malloc","realloc","mem","offset","code","sha256","input","deferred2_0","deferred2_1","ptr0","len0","solve_pow_full","challenge","difficulty","max_iterations","solve_pow_batch","start_nonce","batch_size","EXPECTED_RESPONSE_TYPES","__wbg_load","module","imports","e","bytes","instance","__wbg_get_imports","table","__wbg_finalize_init","__wbg_init","initSync","module_or_path"],"mappings":"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"}